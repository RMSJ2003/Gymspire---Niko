extends base

block styles
  link(rel="stylesheet" href="/css/dashboard.css")

block content

  include _quote


  // =========================
  // NAVBAR
  // =========================
  nav.navbar
    .nav-logo
      if user.userType === "user"
        a.dashboard-btn(href='/dashboard') GymSpire
      if user.userType === "coach"
        a.dashboard-btn(href='/coachDashboard') GymSpire
      if user.userType === "admin"
        a.dashboard-btn(href='/adminDashboard') GymSpire

    // Centered time
    .nav-center
      span.nav-time
        | Current time: 
        strong #{currentTime || '12:00 PM'}

    .nav-right
      button.hamburger ☰
      .panel
        a(href="/profile") Profile
        form(action="/api/v1/auth/logout" method="GET")
          button(type="submit") Logout

  // =========================
  // WELCOME SECTION
  // =========================
  .welcome-section
    img.app-logo(src="/img/gymspirelogo.png" alt="GymSpire Logo")
    h2 Welcome, #{user.username}

  // =========================
  // STATUS + EXERCISE LOG CONTAINERS
  // =========================
  .status-exercise-grid
    // Recommended to workout now
    .status-card
      p
        if recommended
          strong Recommended to workout now
        else
          strong Not recommended to workout now
      p #{message}
      p
        | Current gym load: 
        data(value=currentLoad) #{currentLoad}

    // Currently Working Out
    .status-card
      h3 Currently Working Out
      if onlineUsers.length === 0
        p No users are currently working out.
      else
        .online-users
          each u in onlineUsers
            .online-user
              if u.pfpUrl
                img(
                  src=u.pfpUrl
                  alt=u.username
                  width="40"
                  height="40"
                  style="border-radius:50%;"
                )
              else
                img(
                  src="/img/default-user.png"
                  alt=u.username
                  width="40"
                  height="40"
                  style="border-radius:50%;"
                )
              span= u.username

    // Current Exercise Log
    .exercise-log-card
      h3 Current Exercise Log
      if frequencies.length === 0
        p No workout data available for this week.
      else
        ul.exercise-list
          each item in frequencies
            li
              span.muscle-name #{item.muscle}:
              span.muscle-count #{item.trained} / #{item.target}

  // =========================
  // WORKOUTS THIS WEEK
  // =========================
  .workout-week-card
    p
      | Workouts this week: 
      if workoutCount === 0
        strong No workout yet
      else
        strong #{workoutCount}

  // =========================
  // DASHBOARD GRID
  // =========================
  .dashboard(data-type="user")
    - const cards = ["Challenges", "Workout Plan", "Workout Logs", "Solo Workout"];
    each item, index in cards
      .card
        h3 #{item === 'Solo Workout' ? 'Start Workout' : item}
        .card-actions
          - let url = '/' + item.toLowerCase().replaceAll(' ', '-');
          a.card-link(href=url) #{item}
          button.info-btn(data-index=index title="More Info") i

  // =========================
  // MODAL (TEXT ONLY)
  // =========================
  .modal.hidden#modal
    .modal-content
      button#closeModal ×
      p#modalText

  // =========================
  // DASHBOARD JS
  // =========================
  script(src="/js/dashboard.js")
